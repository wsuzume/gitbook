# 球面幾何（楕円幾何）

## 球面幾何（楕円幾何）

球面幾何（spherical geometry）は楕円幾何（elliptic geometry）の特殊な場合であり、楕円幾何は曲率が正の非ユークリッド幾何である。たとえば地球の地表は2次元の球面で近似することができ、ある方向に「まっすぐ」進むといつかは元の場所に戻ってくる「閉じた」空間である。

これは数学的にはより高次元の空間にも拡張できる。相対論が適用できるような規模では我々の宇宙空間も「閉じて」いるかもしれず、宇宙の果てに向かって「まっすぐ」進んで行ったらいつかはもと地球があった場所に戻ってくるかもしれない。

宇宙の果てはどうなっているか知りようがないのだが、もっと身近で簡単に次元が膨れ上がるのが「データ」である。100種類のカラムを持つデータは100次元のユークリッド空間上の点として表現されていることになるが、適切な写像を定義することで非ユークリッド空間上に「写す」ことができる。もっとも簡単には、単に各ベクトルをそのノルムで割ってノルムを 1 にする正規化の操作を行うと、データは99次元の球面上に写されたことになる。

球面幾何はコンピュータと非常に相性がよい幾何のひとつだと私は考えている。コンピュータは有限の範囲、有限の精度でしか数値を表現できないので、ノルムが定数で各座標も大きな値を取れない球面幾何はオーバーフローの心配がないのである。

適切な座標変換を与えれば楕円幾何は常に球面幾何に翻訳できるので、ここでは取り扱いが簡単な球面幾何についてのみ考察する。

## 球面

$$n$$次元球面$$S^n$$は$$n+1$$次元のユークリッド空間$$\mathbb{R} ^ {n+1}$$で原点からの距離が 1 の点をすべて集めた部分空間として定義される。つまり

$$
S ^ n = \{ x \mid \|x\| = 1,\, x \in \mathbb{R} ^ {n + 1} \}
$$

である。$$n=1$$のときは「円」、$$n=2$$のときは「球面」として我々が認識しているもので、通常は$$n \geq3$$の$$n$$次元球面を想像することはできず、それらは十把一絡げに「超球面」と呼ばれる。

厳密には、球面$$S^n$$はユークリッド空間$$\mathbb{R} ^ {n+1}$$に埋め込まれたときのみ球面となる。たとえば$$S^1$$は我々が認識する「円」であり、これを我々が生活している3次元ユークリッド空間$$\mathbb{R} ^ {3}$$に埋め込んでもそれはやはり円に過ぎず球面とはみなされない。逆に$$S ^ 2$$は我々が認識する「球面」であり、これを2次元のユークリッド空間$$\mathbb{R} ^ 2$$である平面に「描き込む」ことはできない。2次元ユークリッド空間$$\mathbb{R} ^ 2$$における球面は円$$S ^ 1$$である。

## 球面上の座標

球面上の任意の点$$x$$は、零ベクトルではないあるユークリッド空間上のベクトル$$v$$を用いて

$$
x = \frac{v}{\| v \|}
$$

と表せる。ただし$$\| \cdot \|$$はベクトルのノルム（ユークリッドノルム）である。通常は$$\| v \| = 1$$のもので代表するが、ノルムは任意でもよい。この表現を用いる場合、$$n$$次元球面上の点を表現するのに$$n+1$$次元のベクトルを用いることになる。

極座標を用いるとノルムの情報を保存する必要がないので$$n$$ 個の角度を保存することで必要十分な情報を扱えるが、数値計算上の利点はほぼない上に、$$n \gg 1$$の状況では大してメモリ効率がよくなるわけでもない。したがって本書では極座標は取り扱わない。

## 球面上の2点間の距離

「飛行機は世界地図の上をまっすぐには飛ばない」という事実を中学校や高校で習って覚えている人もいることだろう。球面上の2点間の距離（球面上を移動したときの最短ルート）は大円（その2点と原点を通る平面で球面を切断して断面にできる円）に沿った短い方の弧である。

数値的に計算するには、2点$$x,y$$間の球面上での距離$$d(x,y)$$は

$$
d(x,y) = \arccos \left( \frac{ | x \cdot y |}{ \| x \| \| y \|} \right)
$$

である。

## 球面上の3点が作る三角形の面積

## 球面上の確率分布



## 球面の接ベクトル空間

球面上で定義された関数の勾配を考えるには接ベクトル空間の概念が必要になってくる。ユークリッド空間では気にする必要がなかったが、勾配には「勾配に沿って少しだけ動いても空間からはみ出さない」という性質がある（微分幾何、リーマン多様体などの範囲）。

具体的には円の接線を考えてもらえればよい。円のある接点からそこでの接線に沿ってほんの少しだけ動いても、円からははみ出さないように見える。接線以外の方向へ移動すれば、どれだけ慎重にほんのちょっと動いたとしても円からはみ出してしまうだろう。

この接線の概念を$$n$$次元球面に一般化したのが**接ベクトル空間**（tangent vector space）である。接ベクトル空間は単に接空間（tangent space）ともいう。

